<%= content_for :html_title, "Pokok Pikiran" %>
<%= content_for :navigation do %>
  <li class="breadcrumb-item" aria-current="page">Usulan</li>
  <li class="breadcrumb-item active" aria-current="page">Pokok Pikiran</li>
<% end %>
<% content_for :view_utama do %>
  <div class="card border-0 shadow">
    <div class="card-header">
      <div class="row align-items-center">
        <div class="col">
          <h2 class="fs-5 fw-bold mb-0">Usulan Pokok Pikiran DPRD Tahun <%= @tahun_bener %></h2>
        </div>
        <% unless guest? %>
          <div class="col text-end">
            <%= link_to "Tambah Usulan", new_pokpir_path,
                        remote: true,
                        data: {
                          controller: 'form-modal',
                          action: 'ajax:complete->form-modal#success:prevent',
                          bs_toggle: 'modal',
                          bs_target: '#form-modal'
                        },
                        class: "btn btn-sm btn-info" %>
          </div>
          <% if current_user.has_role? :super_admin %>
            <div class="col-auto text-end">
              <%= link_to sync_pokpir_path(kode_opd: '', tahun: 2023),
                          remote: true,
                          data: { disable_with: 'Memproses....'},
                          class:"btn btn-sm btn-primary" do %>
                <i class="fas fa-sync me-2"></i>
                Sync Pokok Pikiran tahun 2023
              <% end %>
            </div>
            <div class="col-auto text-end">
              <%= link_to update_opd_pokpir_path,
                          method: :post,
                          data: { disable_with: 'Memproses....'},
                          class:"btn btn-sm btn-primary" do %>
                <i class="fas fa-sync me-2"></i>
                Sync Kamus
              <% end %>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-flush counter" data-datatable>
          <caption>Usulan Pokok Pikiran OPD <%= current_user.opd.nama_opd %></caption>
          <thead class="thead-light">
            <tr>
              <th class="border-bottom text-gray-700" scope="col">No.</th>
              <th class="border-bottom text-gray-700" scope="col">Tahun</th>
              <th class="border-bottom text-gray-700" scope="col">Usulan</th>
              <th class="border-bottom text-gray-700" scope="col">Alamat</th>
              <th class="border-bottom text-gray-700" scope="col">Permasalahan</th>
              <th class="border-bottom text-gray-700" scope="col">OPD</th>
              <th class="border-bottom text-gray-700" scope="col">Pengambil Usulan</th>
              <th class="border-bottom text-gray-700 text-center" scope="col">Status</th>
              <th class="border-bottom text-gray-700 text-center" scope="col" colspan="1">Action</th>
            </tr>
          </thead>
          <tbody id="new_pokpir">
            <%= render @pokpirs %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
<% end %>
